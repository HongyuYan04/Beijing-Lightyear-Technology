{"remainingRequest":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\src\\views\\attendance\\leave\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\src\\views\\attendance\\leave\\index.vue","mtime":1680769952000},{"path":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\babel.config.js","mtime":1680769952000},{"path":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\小白\\Desktop\\人力资源管理系统\\hrm-master\\vue-elementui-hrm\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGVkaXQsIGdldEV4cG9ydEFwaSwgZ2V0SW1wb3J0QXBpLCBnZXRMaXN0IH0gZnJvbSAnLi4vLi4vLi4vYXBpL3N0YWZmTGVhdmUnOwppbXBvcnQgeyBtYXBTdGF0ZSB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyBnZXRBbGxEZXB0IH0gZnJvbSAnQC9hcGkvZGVwdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTGVhdmUnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWFyY2hGb3JtOiB7CiAgICAgICAgZGVwdExpc3Q6IFtdLAogICAgICAgIGZvcm1EYXRhOiB7fQogICAgICB9LAogICAgICB0YWJsZTogewogICAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgICAgcGFnZUNvbmZpZzogewogICAgICAgICAgdG90YWw6IDEwLAogICAgICAgICAgLy8g6K6w5b2V5oC75pWwCiAgICAgICAgICBjdXJyZW50OiAxLAogICAgICAgICAgLy8g6LW35aeL6aG1CiAgICAgICAgICBzaXplOiAxMCAvLyDmr4/pobXlsZXnpLrnmoTorrDlvZXmlbAKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoJ3Rva2VuJywgWyd0b2tlbiddKSwKICAgIGhlYWRlcnMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdG9rZW46IHRoaXMudG9rZW4KICAgICAgfTsKICAgIH0sCiAgICAvLyDojrflj5blr7zlhaXmlbDmja7nmoTmjqXlj6MKICAgIGltcG9ydEFwaSgpIHsKICAgICAgcmV0dXJuIGdldEltcG9ydEFwaSgpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXBwcm92ZShyb3cpIHsKICAgICAgLy8g6YCa6L+HCiAgICAgIHJvdy5zdGFmZkxlYXZlLnN0YXR1cyA9IHJvdy5hcHByb3ZlOwogICAgICBlZGl0KHJvdy5zdGFmZkxlYXZlKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBpZiAocmVzcG9uc2UuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmxvYWRpbmcoKTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5a6h5om56YCa6L+HJyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZWplY3Qocm93KSB7CiAgICAgIHJvdy5zdGFmZkxlYXZlLnN0YXR1cyA9IHJvdy5yZWplY3Q7CiAgICAgIGVkaXQocm93LnN0YWZmTGVhdmUpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMubG9hZGluZygpOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6amz5ZueJyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVTaXplQ2hhbmdlKHNpemUpIHsKICAgICAgdGhpcy50YWJsZS5wYWdlQ29uZmlnLnNpemUgPSBzaXplOwogICAgICB0aGlzLmxvYWRpbmcoKTsKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKGN1cnJlbnQpIHsKICAgICAgdGhpcy50YWJsZS5wYWdlQ29uZmlnLmN1cnJlbnQgPSBjdXJyZW50OwogICAgICB0aGlzLmxvYWRpbmcoKTsKICAgIH0sCiAgICBzZWFyY2goKSB7CiAgICAgIHRoaXMubG9hZGluZygpOwogICAgfSwKICAgIC8vIOmHjee9ruaQnOe0ouihqOWNlQogICAgcmVzZXQoKSB7CiAgICAgIHRoaXMuc2VhcmNoRm9ybS5mb3JtRGF0YSA9IHt9OwogICAgICB0aGlzLmxvYWRpbmcoKTsKICAgIH0sCiAgICAvLyDlsIbmlbDmja7muLLmn5PliLDmqKHmnb8KICAgIGxvYWRpbmcoKSB7CiAgICAgIGdldEFsbERlcHQoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zdCBsaXN0ID0gW107CiAgICAgICAgcmVzcG9uc2UuZGF0YS5mb3JFYWNoKGRlcHQgPT4gewogICAgICAgICAgaWYgKGRlcHQuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICBkZXB0LmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgbGlzdC5wdXNoKGRlcHQpOwogICAgICAgICAgICBkZXB0LmNoaWxkcmVuLmZvckVhY2goc3ViRGVwdCA9PiB7CiAgICAgICAgICAgICAgbGlzdC5wdXNoKHN1YkRlcHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB0aGlzLnNlYXJjaEZvcm0uZGVwdExpc3QgPSBsaXN0OwogICAgICB9KTsKICAgICAgZ2V0TGlzdCh7CiAgICAgICAgY3VycmVudDogdGhpcy50YWJsZS5wYWdlQ29uZmlnLmN1cnJlbnQsCiAgICAgICAgc2l6ZTogdGhpcy50YWJsZS5wYWdlQ29uZmlnLnNpemUsCiAgICAgICAgbmFtZTogdGhpcy5zZWFyY2hGb3JtLmZvcm1EYXRhLm5hbWUsCiAgICAgICAgZGVwdElkOiB0aGlzLnNlYXJjaEZvcm0uZm9ybURhdGEuZGVwdElkCiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMudGFibGUudGFibGVEYXRhID0gcmVzcG9uc2UuZGF0YS5saXN0OwogICAgICAgICAgdGhpcy50YWJsZS5wYWdlQ29uZmlnLnRvdGFsID0gcmVzcG9uc2UuZGF0YS50b3RhbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwb25zZS5tZXNzYWdlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOWvvOWHuuaVsOaNrgogICAgZXhwb3J0RGF0YSgpIHsKICAgICAgd2luZG93Lm9wZW4oZ2V0RXhwb3J0QXBpKCkpOwogICAgfSwKICAgIGhhbmRsZUltcG9ydFN1Y2Nlc3MocmVzcG9uc2UpIHsKICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT09IDIwMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5pWw5o2u5a+85YWl5oiQ5Yqf77yBJyk7CiAgICAgICAgdGhpcy5sb2FkaW5nKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5pWw5o2u5a+85YWl5aSx6LSl77yBJyk7CiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRpbmcoKTsKICB9Cn07"},{"version":3,"names":["edit","getExportApi","getImportApi","getList","mapState","getAllDept","name","data","searchForm","deptList","formData","table","tableData","pageConfig","total","current","size","computed","headers","token","importApi","methods","approve","row","staffLeave","status","then","response","code","loading","$message","success","reject","error","handleSizeChange","handleCurrentChange","search","reset","list","forEach","dept","children","length","disabled","push","subDept","deptId","message","exportData","window","open","handleImportSuccess","created"],"sources":["src/views/attendance/leave/index.vue"],"sourcesContent":["<template>\n  <div class=\"manage\">\n\n    <!--操作-->\n    <div style=\"margin-bottom: 10px\">\n      <el-upload :action=\"importApi\" :headers=\"headers\" accept=\"xlsx\" :show-file-list=\"false\"\n                 :on-success=\"handleImportSuccess\" :multiple=\"false\"\n                 style=\"display:inline-block\">\n        <el-button type=\"success\" size=\"mini\"\n        >导入 <i class=\"el-icon-bottom\"></i>\n        </el-button>\n      </el-upload>\n      <el-button type=\"warning\" size=\"mini\" @click=\"exportData\" style=\"margin-left: 10px\"\n      >导出 <i class=\"el-icon-top\"></i>\n      </el-button>\n    </div>\n\n    <!------------------------- 搜索 -------------------------------->\n    <div class=\"manage-header\">\n      <el-form label-width=\"auto\" :model=\"searchForm.formData\"\n               :inline=\"true\" size=\"mini\">\n        <el-form-item label=\"姓名\" prop=\"name\">\n          <el-input\n            placeholder=\"请输入姓名\"\n            v-model.trim=\"searchForm.formData.name\"\n            prefix-icon=\"el-icon-search\"\n          />\n        </el-form-item>\n        <el-form-item label=\"部门\" prop=\"deptId\">\n          <el-select\n            placeholder=\"请选择部门\"\n            v-model=\"searchForm.formData.deptId\"\n          >\n            <el-option\n              v-for=\"option in searchForm.deptList\"\n              :key=\"option.id\"\n              :label=\"option.name\"\n              :value=\"option.id\"\n              :disabled=\"option.disabled\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"search\" size=\"mini\">搜索 <i class=\"el-icon-search\"/></el-button>\n          <el-button type=\"danger\" @click=\"reset\" size=\"mini\">重置 <i class=\"el-icon-refresh-left\"/></el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <!------------------------ 数据表格 ----------------------->\n    <div class=\"common-table\">\n      <el-table\n        :data=\"table.tableData\"\n        height=\"85%\"\n        border\n        stripe\n        row-key=\"id\"\n        :header-cell-style=\"{background: '#eef1f6',color: '#606266',\n        textAlign:'center',fontWeight:'bold',borderWidth:'3px'}\"\n      >\n        <el-table-column prop=\"staffLeave.code\" label=\"工号\" min-width=\"80\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.name\" label=\"姓名\" min-width=\"80\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.deptName\" label=\"部门\" min-width=\"125\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.phone\" label=\"电话\" min-width=\"125\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.createTime\" label=\"申请时间\" min-width=\"180\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.typeNum\" label=\"类型\" min-width=\"125\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.startDate\" label=\"开始日期\" min-width=\"125\" align=\"center\"/>\n        <el-table-column prop=\"staffLeave.days\" label=\"天数\" min-width=\"80\" align=\"center\"/>\n        <el-table-column label=\"审核状态\" min-width=\"85\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-tag :type=\"scope.row.tagType\">{{ scope.row.staffLeave.status }}</el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"备注\" width=\"200\" prop=\"staffLeave.remark\" align=\"center\"/>\n        <el-table-column label=\"操作\" width=\"190\" fixed=\"right\" align=\"center\">\n          <template slot-scope=\"scope\">\n            <el-button size=\"mini\" type=\"primary\" @click=\"approve(scope.row)\"\n                       :disabled=\"scope.row.staffLeave.status!==scope.row.unaudited\"\n            >批准 <i class=\"el-icon-check\"></i\n            ></el-button>\n            <el-button size=\"mini\" type=\"danger\" @click=\"reject(scope.row)\"\n                       :disabled=\"scope.row.staffLeave.status!==scope.row.unaudited\"\n            >驳回 <i class=\"el-icon-close\"></i\n            ></el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <el-pagination\n        class=\"pager\"\n        layout=\"total,sizes,prev,pager,next,jumper\"\n        :page-size=\"table.pageConfig.size ? table.pageConfig.size : 10\"\n        :page-sizes=\"[5, 10, 15, 20]\"\n        :total=\"table.pageConfig.total\"\n        :current-page.sync=\"table.pageConfig.current\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n      ></el-pagination>\n    </div>\n  </div>\n</template>\n<script>\nimport { edit, getExportApi, getImportApi, getList } from '../../../api/staffLeave'\nimport { mapState } from 'vuex'\nimport { getAllDept } from '@/api/dept'\n\nexport default {\n  name: 'Leave',\n  data () {\n    return {\n      searchForm: {\n        deptList: [],\n        formData: {}\n      },\n      table: {\n        tableData: [],\n        pageConfig: {\n          total: 10, // 记录总数\n          current: 1, // 起始页\n          size: 10 // 每页展示的记录数\n        }\n      }\n    }\n  },\n  computed: {\n    ...mapState('token', ['token']),\n    headers () {\n      return { token: this.token }\n    },\n    // 获取导入数据的接口\n    importApi () {\n      return getImportApi()\n    }\n\n  },\n  methods: {\n    approve (row) {\n      // 通过\n      row.staffLeave.status = row.approve\n      edit(row.staffLeave).then(response => {\n        if (response.code === 200) {\n          this.loading()\n          this.$message.success('审批通过')\n        }\n      })\n    },\n    reject (row) {\n      row.staffLeave.status = row.reject\n      edit(row.staffLeave).then(response => {\n        if (response.code === 200) {\n          this.loading()\n          this.$message.error('驳回')\n        }\n      })\n    },\n    handleSizeChange (size) {\n      this.table.pageConfig.size = size\n      this.loading()\n    },\n    handleCurrentChange (current) {\n      this.table.pageConfig.current = current\n      this.loading()\n    },\n    search () {\n      this.loading()\n    },\n    // 重置搜索表单\n    reset () {\n      this.searchForm.formData = {}\n      this.loading()\n    },\n    // 将数据渲染到模板\n    loading () {\n      getAllDept().then(response => {\n        const list = []\n        response.data.forEach(dept => {\n          if (dept.children.length > 0) {\n            dept.disabled = true\n            list.push(dept)\n            dept.children.forEach(subDept => {\n              list.push(subDept)\n            })\n          }\n        })\n        this.searchForm.deptList = list\n      })\n      getList({\n        current: this.table.pageConfig.current,\n        size: this.table.pageConfig.size,\n        name: this.searchForm.formData.name,\n        deptId: this.searchForm.formData.deptId\n      }).then(response => {\n        if (response.code === 200) {\n          this.table.tableData = response.data.list\n          this.table.pageConfig.total = response.data.total\n        } else {\n          this.$message.error(response.message)\n        }\n      })\n    },\n    // 导出数据\n    exportData () {\n      window.open(getExportApi())\n    },\n    handleImportSuccess (response) {\n      if (response.code === 200) {\n        this.$message.success('数据导入成功！')\n        this.loading()\n      } else {\n        this.$message.error('数据导入失败！')\n      }\n    }\n  },\n  created () {\n    this.loading()\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.common-table {\n  height: calc(100% - 62px);\n  background-color: white;\n  position: relative;\n\n  .pager {\n    position: absolute;\n    bottom: 20px;\n    right: 20px;\n  }\n}\n\n</style>\n"],"mappings":"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"}]}